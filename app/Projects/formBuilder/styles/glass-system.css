/* ðŸŽ¨ Liquid Glass Design System - Form Builder Components */
/* Comprehensive implementation matching specification docs */
/* Based on docs/__Specifications/05_LiquidGlassDesignSystem_specification.md */

/* ===== CRITICAL ACCESSIBILITY NOTE ===== */
/*
 * ðŸš¨ DIALOG READABILITY REQUIREMENT:
 * Dialogs appear over dark backdrops making glass text unreadable.
 * SOLUTION: All dialog content must use user's current background
 * behind text areas while maintaining glass aesthetic on borders.
 * This ensures text readability while preserving the glass design.
 */

/* ===== CSS CUSTOM PROPERTIES ===== */
:root {
  /* Backdrop Blur Levels */
  --glass-blur-small: 32px;
  --glass-blur-medium: 40px;
  --glass-blur-large: 48px;
  --glass-blur-intense: 56px;
  
  /* Saturation (vibrancy) */
  --glass-saturation: 1.5;

  /* Transparency Levels */
  --glass-alpha-light: 0.08;
  --glass-alpha-medium: 0.12;
  --glass-alpha-heavy: 0.18;
  --glass-alpha-opaque: 0.25;

  /* Border Definition */
  --glass-border-light: rgba(255, 255, 255, 0.12);
  --glass-border-medium: rgba(255, 255, 255, 0.18);
  --glass-border-strong: rgba(255, 255, 255, 0.25);

  /* Shadow System */
  --glass-shadow-sm: 0 4px 16px rgba(0, 0, 0, 0.08);
  --glass-shadow-md: 0 8px 32px rgba(0, 0, 0, 0.12);
  --glass-shadow-lg: 0 12px 40px rgba(0, 0, 0, 0.18);
  --glass-shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.24);

  /* Dark Mode Shadows */
  --glass-shadow-dark-sm: 0 4px 16px rgba(0, 0, 0, 0.20);
  --glass-shadow-dark-md: 0 8px 32px rgba(0, 0, 0, 0.30);
  --glass-shadow-dark-lg: 0 12px 40px rgba(0, 0, 0, 0.40);
  --glass-shadow-dark-xl: 0 16px 48px rgba(0, 0, 0, 0.50);

  /* Text Colors - Optimized for Glass Backgrounds */
  --glass-text-primary: rgba(0, 0, 0, 0.90);
  --glass-text-secondary: rgba(0, 0, 0, 0.70);
  --glass-text-tertiary: rgba(0, 0, 0, 0.50);
  --glass-text-primary-dark: rgba(255, 255, 255, 0.95);
  --glass-text-secondary-dark: rgba(255, 255, 255, 0.75);
  --glass-text-tertiary-dark: rgba(255, 255, 255, 0.55);

  /* Interactive Elements */
  --glass-interactive: rgba(0, 122, 255, 0.80);
  --glass-interactive-hover: rgba(0, 122, 255, 0.90);
  --glass-interactive-pressed: rgba(0, 122, 255, 1.00);

  /* Status Colors (use sparingly) */
  --glass-success: rgba(52, 199, 89, 0.15);
  --glass-warning: rgba(255, 204, 0, 0.15);
  --glass-error: rgba(255, 59, 48, 0.15);
  --glass-info: rgba(0, 122, 255, 0.15);
  
  /* Status Text */
  --glass-success-text: rgba(52, 199, 89, 0.90);
  --glass-warning-text: rgba(255, 204, 0, 0.90);
  --glass-error-text: rgba(255, 59, 48, 0.90);
  --glass-info-text: rgba(0, 122, 255, 0.90);
  
  /* ===== APPLE-INSPIRED TYPOGRAPHY SYSTEM ===== */
  
  /* Font Stacks - Apple System Font Priority */
  --glass-font-system: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", sans-serif;
  --glass-font-mono: "SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, monospace;
  --glass-font-serif: "New York", Georgia, "Times New Roman", serif;
  
  /* Font Weights - Apple SF Pro Scale */
  --glass-weight-ultralight: 100;
  --glass-weight-thin: 200;
  --glass-weight-light: 300;
  --glass-weight-regular: 400;
  --glass-weight-medium: 500;
  --glass-weight-semibold: 600;
  --glass-weight-bold: 700;
  --glass-weight-heavy: 800;
  --glass-weight-black: 900;
  
  /* Text Styles - Apple Typography Scale */
  --glass-text-large-title: 2.125rem;      /* 34px - Hero sections */
  --glass-text-title-1: 1.75rem;           /* 28px - Page titles */
  --glass-text-title-2: 1.375rem;          /* 22px - Section headings */
  --glass-text-title-3: 1.25rem;           /* 20px - Subsection headings */
  --glass-text-headline: 1.0625rem;        /* 17px - Card titles, important labels */
  --glass-text-body: 1.0625rem;            /* 17px - Primary body text */
  --glass-text-callout: 1rem;              /* 16px - Secondary body text */
  --glass-text-subhead: 0.9375rem;         /* 15px - Supporting text */
  --glass-text-footnote: 0.8125rem;        /* 13px - Caption text, metadata */
  --glass-text-caption-1: 0.75rem;         /* 12px - Fine print, timestamps */
  --glass-text-caption-2: 0.6875rem;       /* 11px - Smallest readable text */
  
  /* Line Heights - Optimized for readability */
  --glass-line-height-large-title: 1.2;
  --glass-line-height-title: 1.21;
  --glass-line-height-headline: 1.29;
  --glass-line-height-body: 1.29;
  --glass-line-height-caption: 1.33;
  
  /* Letter Spacing - Apple-inspired tracking */
  --glass-letter-spacing-tight: -0.02em;   /* Large titles */
  --glass-letter-spacing-normal: 0;        /* Body text */
  --glass-letter-spacing-wide: 0.01em;     /* Small text */
}

/* ===== CORE GLASS CLASSES ===== */

/* Small elements: buttons, badges, toolbars, tabs */
.glass-small {
  position: relative;
  z-index: 0;
  -webkit-backdrop-filter: blur(var(--glass-blur-small)) saturate(var(--glass-saturation));
  backdrop-filter: blur(var(--glass-blur-small)) saturate(var(--glass-saturation));
  background: rgba(255, 255, 255, var(--glass-alpha-light));
  border: 1px solid var(--glass-border-light);
  box-shadow: var(--glass-shadow-sm);
  transition: all 0.3s ease-out;
}

.glass-small:hover {
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.18);
}

[data-theme="dark"] .glass-small {
  background: rgba(255, 255, 255, 0.05);
  border-color: rgba(255, 255, 255, 0.08);
  box-shadow: var(--glass-shadow-dark-sm);
}

[data-theme="dark"] .glass-small:hover {
  background: rgba(255, 255, 255, 0.08);
  border-color: rgba(255, 255, 255, 0.12);
}

/* Medium elements: cards, panels, dropdowns, small modals */
.glass-medium {
  position: relative;
  z-index: 0;
  -webkit-backdrop-filter: blur(var(--glass-blur-medium)) saturate(var(--glass-saturation)) !important;
  backdrop-filter: blur(var(--glass-blur-medium)) saturate(var(--glass-saturation)) !important;
  background: rgba(255, 255, 255, 0.25) !important; /* Temporarily higher for debugging */
  border: 1px solid var(--glass-border-medium) !important;
  box-shadow: var(--glass-shadow-md) !important;
  transition: all 0.5s ease-out;
}

.glass-medium:hover {
  background: rgba(255, 255, 255, 0.35) !important;
  box-shadow: var(--glass-shadow-lg) !important;
}

.glass-medium::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  background: linear-gradient(
    to bottom right,
    rgba(255, 255, 255, 0.10),
    rgba(255, 255, 255, 0.03),
    transparent
  );
  opacity: 0.6;
  z-index: 0;
}

[data-theme="dark"] .glass-medium {
  background: rgba(255, 255, 255, 0.08);
  border-color: rgba(255, 255, 255, 0.12);
  box-shadow: var(--glass-shadow-dark-md);
}

[data-theme="dark"] .glass-medium:hover {
  background: rgba(255, 255, 255, 0.12);
  box-shadow: var(--glass-shadow-dark-lg);
}

[data-theme="dark"] .glass-medium::before {
  background: linear-gradient(
    to bottom right,
    rgba(255, 255, 255, 0.06),
    rgba(255, 255, 255, 0.02),
    transparent
  );
}

/* Large elements: sidebars, large dialogs, main panels */
.glass-large {
  position: relative;
  z-index: 0;
  -webkit-backdrop-filter: blur(var(--glass-blur-large)) saturate(var(--glass-saturation)) !important;
  backdrop-filter: blur(var(--glass-blur-large)) saturate(var(--glass-saturation)) !important;
  background: rgba(255, 255, 255, 0.3) !important; /* Temporarily higher for debugging */
  border: 1px solid var(--glass-border-medium) !important;
  box-shadow: var(--glass-shadow-lg) !important;
  transition: all 0.5s ease-out;
}

.glass-large:hover {
  background: rgba(255, 255, 255, 0.4) !important;
  border-color: var(--glass-border-strong);
  -webkit-backdrop-filter: blur(var(--glass-blur-intense)) saturate(var(--glass-saturation)) !important;
  backdrop-filter: blur(var(--glass-blur-intense)) saturate(var(--glass-saturation)) !important;
}

.glass-large::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  background: linear-gradient(
    to bottom right,
    rgba(255, 255, 255, 0.15),
    rgba(255, 255, 255, 0.05),
    transparent
  );
  opacity: 0.6;
  z-index: 0;
}

.glass-large::after {
  content: "";
  position: absolute;
  inset: 1px;
  border-radius: calc(inherit - 1px);
  pointer-events: none;
  background: linear-gradient(
    to bottom right,
    transparent,
    rgba(255, 255, 255, 0.03),
    rgba(255, 255, 255, 0.08)
  );
  opacity: 0.5;
  z-index: 0;
}

[data-theme="dark"] .glass-large {
  background: rgba(255, 255, 255, 0.05);
  border-color: rgba(255, 255, 255, 0.12);
  box-shadow: var(--glass-shadow-dark-lg);
}

[data-theme="dark"] .glass-large:hover {
  background: rgba(255, 255, 255, 0.08);
}

[data-theme="dark"] .glass-large::before {
  background: linear-gradient(
    to bottom right,
    rgba(255, 255, 255, 0.08),
    rgba(255, 255, 255, 0.02),
    transparent
  );
}

[data-theme="dark"] .glass-large::after {
  background: linear-gradient(
    to bottom right,
    transparent,
    rgba(255, 255, 255, 0.01),
    rgba(255, 255, 255, 0.04)
  );
}

/* ===== TEXT UTILITIES ===== */
.glass-text-primary {
  color: var(--glass-text-primary);
}

.glass-text-secondary {
  color: var(--glass-text-secondary);
}

.glass-text-tertiary {
  color: var(--glass-text-tertiary);
}

[data-theme="dark"] .glass-text-primary {
  color: var(--glass-text-primary-dark);
}

[data-theme="dark"] .glass-text-secondary {
  color: var(--glass-text-secondary-dark);
}

[data-theme="dark"] .glass-text-tertiary {
  color: var(--glass-text-tertiary-dark);
}

/* ===== APPLE-INSPIRED TYPOGRAPHY CLASSES ===== */

/* Base Typography Setup */
.glass-typography {
  font-family: var(--glass-font-system);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

/* Text Size Classes - Apple Typography Scale */
.glass-text-large-title {
  font-size: var(--glass-text-large-title);
  line-height: var(--glass-line-height-large-title);
  font-weight: var(--glass-weight-regular);
  letter-spacing: var(--glass-letter-spacing-tight);
  color: var(--glass-text-primary);
}

.glass-text-title-1 {
  font-size: var(--glass-text-title-1);
  line-height: var(--glass-line-height-title);
  font-weight: var(--glass-weight-regular);
  letter-spacing: var(--glass-letter-spacing-tight);
  color: var(--glass-text-primary);
}

.glass-text-title-2 {
  font-size: var(--glass-text-title-2);
  line-height: var(--glass-line-height-title);
  font-weight: var(--glass-weight-regular);
  letter-spacing: var(--glass-letter-spacing-normal);
  color: var(--glass-text-primary);
}

.glass-text-title-3 {
  font-size: var(--glass-text-title-3);
  line-height: var(--glass-line-height-title);
  font-weight: var(--glass-weight-regular);
  letter-spacing: var(--glass-letter-spacing-normal);
  color: var(--glass-text-primary);
}

.glass-text-headline {
  font-size: var(--glass-text-headline);
  line-height: var(--glass-line-height-headline);
  font-weight: var(--glass-weight-semibold);
  letter-spacing: var(--glass-letter-spacing-normal);
  color: var(--glass-text-primary);
}

.glass-text-body {
  font-size: var(--glass-text-body);
  line-height: var(--glass-line-height-body);
  font-weight: var(--glass-weight-regular);
  letter-spacing: var(--glass-letter-spacing-normal);
  color: var(--glass-text-primary);
}

.glass-text-callout {
  font-size: var(--glass-text-callout);
  line-height: var(--glass-line-height-body);
  font-weight: var(--glass-weight-regular);
  letter-spacing: var(--glass-letter-spacing-normal);
  color: var(--glass-text-secondary);
}

.glass-text-subhead {
  font-size: var(--glass-text-subhead);
  line-height: var(--glass-line-height-body);
  font-weight: var(--glass-weight-regular);
  letter-spacing: var(--glass-letter-spacing-normal);
  color: var(--glass-text-secondary);
}

.glass-text-footnote {
  font-size: var(--glass-text-footnote);
  line-height: var(--glass-line-height-caption);
  font-weight: var(--glass-weight-regular);
  letter-spacing: var(--glass-letter-spacing-wide);
  color: var(--glass-text-tertiary);
}

.glass-text-caption-1 {
  font-size: var(--glass-text-caption-1);
  line-height: var(--glass-line-height-caption);
  font-weight: var(--glass-weight-regular);
  letter-spacing: var(--glass-letter-spacing-wide);
  color: var(--glass-text-tertiary);
}

.glass-text-caption-2 {
  font-size: var(--glass-text-caption-2);
  line-height: var(--glass-line-height-caption);
  font-weight: var(--glass-weight-regular);
  letter-spacing: var(--glass-letter-spacing-wide);
  color: var(--glass-text-tertiary);
}

/* Font Weight Utilities */
.glass-weight-ultralight { font-weight: var(--glass-weight-ultralight); }
.glass-weight-thin { font-weight: var(--glass-weight-thin); }
.glass-weight-light { font-weight: var(--glass-weight-light); }
.glass-weight-regular { font-weight: var(--glass-weight-regular); }
.glass-weight-medium { font-weight: var(--glass-weight-medium); }
.glass-weight-semibold { font-weight: var(--glass-weight-semibold); }
.glass-weight-bold { font-weight: var(--glass-weight-bold); }
.glass-weight-heavy { font-weight: var(--glass-weight-heavy); }
.glass-weight-black { font-weight: var(--glass-weight-black); }

/* Font Family Utilities */
.glass-font-system { font-family: var(--glass-font-system); }
.glass-font-mono { font-family: var(--glass-font-mono); }
.glass-font-serif { font-family: var(--glass-font-serif); }

/* Dark Theme Typography Adjustments */
[data-theme="dark"] .glass-text-large-title,
[data-theme="dark"] .glass-text-title-1,
[data-theme="dark"] .glass-text-title-2,
[data-theme="dark"] .glass-text-title-3,
[data-theme="dark"] .glass-text-headline,
[data-theme="dark"] .glass-text-body {
  color: var(--glass-text-primary-dark);
}

[data-theme="dark"] .glass-text-callout,
[data-theme="dark"] .glass-text-subhead {
  color: var(--glass-text-secondary-dark);
}

[data-theme="dark"] .glass-text-footnote,
[data-theme="dark"] .glass-text-caption-1,
[data-theme="dark"] .glass-text-caption-2 {
  color: var(--glass-text-tertiary-dark);
}

/* Responsive Typography - Mobile Optimization */
@media (max-width: 767px) {
  .glass-text-large-title {
    font-size: calc(var(--glass-text-large-title) * 0.85);
  }
  
  .glass-text-title-1 {
    font-size: calc(var(--glass-text-title-1) * 0.9);
  }
  
  .glass-text-title-2 {
    font-size: calc(var(--glass-text-title-2) * 0.9);
  }
  
  .glass-text-title-3 {
    font-size: calc(var(--glass-text-title-3) * 0.95);
  }
}

/* ===== INTERACTIVE ELEMENTS ===== */

/* Interactive variant for clickable cards/buttons */
.glass-interactive {
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.glass-interactive:hover {
  transform: translateY(-1px) scale(1.01);
  box-shadow: var(--glass-shadow-lg);
}

.glass-interactive:active {
  transform: translateY(0) scale(0.995);
}

/* Ensure content paints above decorative overlays */
.glass-small > *,
.glass-medium > *,
.glass-large > * {
  position: relative;
  z-index: 1;
}

/* ===== FORM BUILDER SPECIFIC COMPONENTS ===== */

/* Glass Buttons */
.glass-button-primary {
  position: relative;
  background: linear-gradient(135deg, 
    rgba(59, 130, 246, 0.90) 0%, 
    rgba(99, 102, 241, 0.90) 100%);
  -webkit-backdrop-filter: blur(10px) saturate(140%);
  backdrop-filter: blur(10px) saturate(140%);
  border: 1px solid rgba(255, 255, 255, 0.20);
  transition: all 0.2s ease-out;
  color: white;
  font-weight: 500;
}

.glass-button-primary:hover {
  -webkit-backdrop-filter: blur(12px) saturate(160%);
  backdrop-filter: blur(12px) saturate(160%);
  transform: translateY(-1px);
  box-shadow: 0 8px 20px rgba(59, 130, 246, 0.35);
}

.glass-button-secondary {
  position: relative;
  background: rgba(255, 255, 255, 0.70);
  -webkit-backdrop-filter: blur(8px) saturate(120%);
  backdrop-filter: blur(8px) saturate(120%);
  border: 1px solid rgba(148, 163, 184, 0.30);
  transition: all 0.2s ease-out;
}

.glass-button-secondary:hover {
  background: rgba(255, 255, 255, 0.80);
  -webkit-backdrop-filter: blur(10px) saturate(140%);
  backdrop-filter: blur(10px) saturate(140%);
  border-color: rgba(148, 163, 184, 0.50);
}

[data-theme="dark"] .glass-button-secondary {
  background: rgba(51, 65, 85, 0.70);
  border: 1px solid rgba(71, 85, 105, 0.50);
}

[data-theme="dark"] .glass-button-secondary:hover {
  background: rgba(51, 65, 85, 0.85);
  border-color: rgba(71, 85, 105, 0.70);
}

/* Glass Panels */
.glass-panel {
  background: rgba(255, 255, 255, 0.85);
  -webkit-backdrop-filter: blur(12px) saturate(120%);
  backdrop-filter: blur(12px) saturate(120%);
  border: 1px solid rgba(226, 232, 240, 0.50);
  border-radius: 12px;
  box-shadow: var(--glass-shadow-md);
}

[data-theme="dark"] .glass-panel {
  background: rgba(30, 41, 59, 0.85);
  border: 1px solid rgba(71, 85, 105, 0.50);
}

.glass-panel-header {
  background: rgba(248, 250, 252, 0.80);
  -webkit-backdrop-filter: blur(8px) saturate(110%);
  backdrop-filter: blur(8px) saturate(110%);
  border-bottom: 1px solid rgba(226, 232, 240, 0.40);
}

[data-theme="dark"] .glass-panel-header {
  background: rgba(15, 23, 42, 0.80);
  border-bottom: 1px solid rgba(71, 85, 105, 0.40);
}

/* Glass Cards */
.glass-card {
  background: rgba(255, 255, 255, 0.75);
  -webkit-backdrop-filter: blur(10px) saturate(115%);
  backdrop-filter: blur(10px) saturate(115%);
  border: 1px solid rgba(226, 232, 240, 0.40);
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: all 0.2s ease-out;
}

.glass-card:hover {
  -webkit-backdrop-filter: blur(12px) saturate(140%);
  backdrop-filter: blur(12px) saturate(140%);
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
}

[data-theme="dark"] .glass-card {
  background: rgba(45, 55, 72, 0.75);
  border: 1px solid rgba(71, 85, 105, 0.40);
}

/* Glass Inputs */
.glass-input {
  background: rgba(255, 255, 255, 0.70);
  -webkit-backdrop-filter: blur(6px) saturate(115%);
  backdrop-filter: blur(6px) saturate(115%);
  border: 1px solid rgba(203, 213, 225, 0.50);
  transition: all 0.2s ease-out;
}

.glass-input:focus {
  -webkit-backdrop-filter: blur(8px) saturate(130%);
  backdrop-filter: blur(8px) saturate(130%);
  border-color: rgba(59, 130, 246, 0.60);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
}

[data-theme="dark"] .glass-input {
  background: rgba(51, 65, 85, 0.70);
  border: 1px solid rgba(71, 85, 105, 0.50);
}

[data-theme="dark"] .glass-input:focus {
  border-color: rgba(99, 102, 241, 0.60);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
}

/* Glass Badges */
.glass-badge {
  background: rgba(255, 255, 255, 0.60);
  -webkit-backdrop-filter: blur(8px) saturate(120%);
  backdrop-filter: blur(8px) saturate(120%);
  border: 1px solid rgba(226, 232, 240, 0.50);
}

[data-theme="dark"] .glass-badge {
  background: rgba(51, 65, 85, 0.60);
  border: 1px solid rgba(71, 85, 105, 0.50);
}

.glass-badge-success {
  background: var(--glass-success);
  border: 1px solid rgba(52, 199, 89, 0.30);
  color: var(--glass-success-text);
}

[data-theme="dark"] .glass-badge-success {
  background: rgba(52, 199, 89, 0.20);
  color: rgb(74, 222, 128);
}

.glass-badge-warning {
  background: var(--glass-warning);
  border: 1px solid rgba(255, 204, 0, 0.30);
  color: var(--glass-warning-text);
}

[data-theme="dark"] .glass-badge-warning {
  background: rgba(255, 204, 0, 0.20);
  color: rgb(251, 191, 36);
}

.glass-badge-error {
  background: var(--glass-error);
  border: 1px solid rgba(255, 59, 48, 0.30);
  color: var(--glass-error-text);
}

[data-theme="dark"] .glass-badge-error {
  background: rgba(255, 59, 48, 0.20);
  color: rgb(248, 113, 113);
}

/* ===== CRITICAL: DIALOG BACKGROUND SYSTEM ===== */
/* 
 * IMPORTANT: Dialogs appear over dark backdrops which make glass text unreadable.
 * Solution: Use user's current background behind content areas for readability.
 * Glass effects are maintained only on borders and non-content areas.
 */

/* Glass Dialog Variants - WITH USER BACKGROUND INTEGRATION */
.glass-dialog-large {
  /* Glass effects only on border/frame */
  -webkit-backdrop-filter: blur(20px) saturate(150%);
  backdrop-filter: blur(20px) saturate(150%);
  border: 1px solid var(--glass-border-medium);
  box-shadow: 0 20px 50px rgba(0, 0, 0, 0.25);
  border-radius: 12px;
  
  /* CRITICAL: Use user's current background for content readability */
  background: var(--background-image, var(--background-gradient, rgba(255, 255, 255, 0.98)));
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
}

.glass-dialog-medium {
  /* Glass effects only on border/frame */
  -webkit-backdrop-filter: blur(15px) saturate(140%);
  backdrop-filter: blur(15px) saturate(140%);
  border: 1px solid var(--glass-border-medium);
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.20);
  border-radius: 10px;
  
  /* CRITICAL: Use user's current background for content readability */
  background: var(--background-image, var(--background-gradient, rgba(255, 255, 255, 0.95)));
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
}

.glass-dialog-compact {
  /* Glass effects only on border/frame */
  -webkit-backdrop-filter: blur(12px) saturate(130%);
  backdrop-filter: blur(12px) saturate(130%);
  border: 1px solid var(--glass-border-light);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
  border-radius: 8px;
  
  /* CRITICAL: Use user's current background for content readability */
  background: var(--background-image, var(--background-gradient, rgba(255, 255, 255, 0.92)));
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
}

/* Dark mode dialog backgrounds - still use user's background */
[data-theme="dark"] .glass-dialog-large {
  background: var(--background-image, var(--background-gradient, rgba(15, 23, 42, 0.98)));
  border: 1px solid rgba(71, 85, 105, 0.50);
}

[data-theme="dark"] .glass-dialog-medium {
  background: var(--background-image, var(--background-gradient, rgba(15, 23, 42, 0.95)));
  border: 1px solid rgba(71, 85, 105, 0.50);
}

[data-theme="dark"] .glass-dialog-compact {
  background: var(--background-image, var(--background-gradient, rgba(30, 41, 59, 0.92)));
  border: 1px solid rgba(71, 85, 105, 0.50);
}

/* ===== DIALOG CONTENT AREAS ===== */
/* Content areas within dialogs need opaque backgrounds for text readability */

.glass-dialog-content {
  /* Ensure content area has solid background matching user's theme */
  background: var(--background-image, var(--background-gradient, rgba(255, 255, 255, 0.95)));
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  border-radius: 8px;
  padding: 1rem;
  position: relative;
}

[data-theme="dark"] .glass-dialog-content {
  background: var(--background-image, var(--background-gradient, rgba(15, 23, 42, 0.95)));
}

/* Text areas within dialogs - maximum readability */
.glass-dialog-text-area {
  background: var(--background-image, var(--background-gradient, rgba(255, 255, 255, 0.98)));
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  border-radius: 6px;
  padding: 0.75rem;
}

[data-theme="dark"] .glass-dialog-text-area {
  background: var(--background-image, var(--background-gradient, rgba(15, 23, 42, 0.98)));
}

/* ===== DIALOG HEADER/FOOTER SPECIAL HANDLING ===== */
.glass-dialog-header,
.glass-dialog-footer {
  /* Headers/footers can have subtle glass but must remain readable */
  background: var(--background-image, var(--background-gradient, rgba(248, 250, 252, 0.95)));
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  -webkit-backdrop-filter: blur(8px) saturate(110%);
  backdrop-filter: blur(8px) saturate(110%);
  border-bottom: 1px solid var(--glass-border-light);
}

[data-theme="dark"] .glass-dialog-header,
[data-theme="dark"] .glass-dialog-footer {
  background: var(--background-image, var(--background-gradient, rgba(15, 23, 42, 0.95)));
}

/* ===== RESPONSIVE GLASS EFFECTS ===== */

/* Mobile optimizations (< 768px) - Reduce blur by 25% for performance */
@media (max-width: 767px) {
  .glass-large {
    -webkit-backdrop-filter: blur(36px) saturate(var(--glass-saturation));
    backdrop-filter: blur(36px) saturate(var(--glass-saturation));
    background: rgba(255, 255, 255, 0.10);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }
  
  [data-theme="dark"] .glass-large {
    background: rgba(255, 255, 255, 0.07);
  }
  
  .glass-medium {
    -webkit-backdrop-filter: blur(30px) saturate(var(--glass-saturation));
    backdrop-filter: blur(30px) saturate(var(--glass-saturation));
  }
  
  .glass-small {
    -webkit-backdrop-filter: blur(24px) saturate(var(--glass-saturation));
    backdrop-filter: blur(24px) saturate(var(--glass-saturation));
  }
}

/* Tablet optimizations (768px - 1023px) - Reduce blur by 15% */
@media (min-width: 768px) and (max-width: 1023px) {
  .glass-large {
    -webkit-backdrop-filter: blur(40px) saturate(var(--glass-saturation));
    backdrop-filter: blur(40px) saturate(var(--glass-saturation));
    background: rgba(255, 255, 255, 0.09);
  }
  
  [data-theme="dark"] .glass-large {
    background: rgba(255, 255, 255, 0.06);
  }
}

/* ===== ACCESSIBILITY & MOTION PREFERENCES ===== */

@media (prefers-reduced-motion: reduce) {
  .glass-large,
  .glass-medium,
  .glass-small,
  .glass-button-primary,
  .glass-button-secondary,
  .glass-card,
  .glass-interactive {
    transition: none !important;
  }
  
  .glass-large:hover,
  .glass-medium:hover,
  .glass-small:hover {
    -webkit-backdrop-filter: inherit !important;
    backdrop-filter: inherit !important;
    transform: none !important;
  }
  
  .glass-interactive:hover,
  .glass-card:hover,
  .glass-button-primary:hover,
  .glass-button-secondary:hover {
    transform: none !important;
  }
}

/* Fallback for browsers without backdrop-filter support */
@supports not (backdrop-filter: blur(1px)) {
  .glass-large,
  .glass-medium,
  .glass-small {
    background: rgba(255, 255, 255, 0.85);
    -webkit-backdrop-filter: none;
    backdrop-filter: none;
  }
  
  [data-theme="dark"] .glass-large,
  [data-theme="dark"] .glass-medium,
  [data-theme="dark"] .glass-small {
    background: rgba(0, 0, 0, 0.75);
  }
}

/* ===== GLASS WITH USER BACKGROUND UTILITIES ===== */
/* For any glass component that needs user background for readability */

.glass-with-user-bg {
  background: var(--background-image, var(--background-gradient, transparent));
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
}

[data-theme="dark"] .glass-with-user-bg {
  background: var(--background-image, var(--background-gradient, transparent));
}

/* Overlay components that appear over dark backdrops */
.glass-overlay-safe {
  /* Glass border effects */
  -webkit-backdrop-filter: blur(12px) saturate(130%);
  backdrop-filter: blur(12px) saturate(130%);
  border: 1px solid var(--glass-border-medium);
  
  /* User background for content readability */
  background: var(--background-image, var(--background-gradient, rgba(255, 255, 255, 0.96)));
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
}

[data-theme="dark"] .glass-overlay-safe {
  background: var(--background-image, var(--background-gradient, rgba(15, 23, 42, 0.96)));
}

/* Floating panels that might appear over various backgrounds */
.glass-floating-safe {
  /* Glass aesthetic maintained */
  -webkit-backdrop-filter: blur(16px) saturate(140%);
  backdrop-filter: blur(16px) saturate(140%);
  border: 1px solid var(--glass-border-medium);
  box-shadow: var(--glass-shadow-lg);
  
  /* Safe background for text readability */
  background: var(--background-image, var(--background-gradient, rgba(255, 255, 255, 0.94)));
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
}

[data-theme="dark"] .glass-floating-safe {
  background: var(--background-image, var(--background-gradient, rgba(15, 23, 42, 0.94)));
  box-shadow: var(--glass-shadow-dark-lg);
}

/* ===== FORM SPECIFIC GLASS STYLES ===== */

.glass-form-container {
  /* Glass border effects */
  -webkit-backdrop-filter: blur(15px) saturate(130%);
  backdrop-filter: blur(15px) saturate(130%);
  border: 1px solid rgba(226, 232, 240, 0.50);
  border-radius: 12px;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  
  /* CRITICAL: Use user background for form readability */
  background: var(--background-image, var(--background-gradient, rgba(255, 255, 255, 0.96)));
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
}

[data-theme="dark"] .glass-form-container {
  background: var(--background-image, var(--background-gradient, rgba(30, 41, 59, 0.96)));
  border: 1px solid rgba(71, 85, 105, 0.50);
}

.glass-form-header {
  /* Subtle glass with user background */
  -webkit-backdrop-filter: blur(12px) saturate(125%);
  backdrop-filter: blur(12px) saturate(125%);
  border-bottom: 1px solid rgba(226, 232, 240, 0.40);
  
  /* Use user background for header readability */
  background: var(--background-image, var(--background-gradient, rgba(248, 250, 252, 0.92)));
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
}

[data-theme="dark"] .glass-form-header {
  background: var(--background-image, var(--background-gradient, rgba(15, 23, 42, 0.92)));
  border-bottom: 1px solid rgba(71, 85, 105, 0.40);
}

.glass-validation-error {
  background: rgba(254, 242, 242, 0.90);
  -webkit-backdrop-filter: blur(10px) saturate(120%);
  backdrop-filter: blur(10px) saturate(120%);
  border: 1px solid rgba(255, 59, 48, 0.30);
}

[data-theme="dark"] .glass-validation-error {
  background: rgba(127, 29, 29, 0.80);
  border: 1px solid rgba(255, 59, 48, 0.50);
}

.glass-validation-success {
  background: rgba(240, 253, 244, 0.90);
  -webkit-backdrop-filter: blur(10px) saturate(120%);
  backdrop-filter: blur(10px) saturate(120%);
  border: 1px solid rgba(52, 199, 89, 0.30);
}

[data-theme="dark"] .glass-validation-success {
  background: rgba(20, 83, 45, 0.80);
  border: 1px solid rgba(52, 199, 89, 0.50);
}

/* ===== FORM FIELD CONTAINERS ===== */

/* Field container for form inputs */
.glass-field-container {
  position: relative;
  margin-bottom: 1.5rem;
}

/* Force glass styling on form input containers */
.glass-field-container .field-input-container,
.field-input-container.glass-small,
.professional-field-wrapper .field-input-container.glass-small {
  position: relative !important;
  z-index: 0 !important;
  -webkit-backdrop-filter: blur(var(--glass-blur-small)) saturate(var(--glass-saturation)) !important;
  backdrop-filter: blur(var(--glass-blur-small)) saturate(var(--glass-saturation)) !important;
  background: rgba(255, 255, 255, 0.6) !important;
  border: 1px solid var(--glass-border-light) !important;
  border-radius: 8px !important;
  padding: 0.5rem !important;
  transition: all 0.3s ease-out !important;
}

.glass-field-container .field-input-container:hover,
.field-input-container.glass-small:hover,
.professional-field-wrapper .field-input-container.glass-small:hover {
  background: rgba(255, 255, 255, 0.75) !important;
  border-color: var(--glass-border-medium) !important;
}

.glass-field-container .field-input-container:focus-within,
.field-input-container.glass-small:focus-within,
.professional-field-wrapper .field-input-container.glass-small:focus-within {
  background: rgba(255, 255, 255, 0.85) !important;
  border-color: var(--glass-interactive) !important;
  box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2) !important;
}

/* Force glass styling for all nested inputs, selects, textareas */
.glass-field-container .field-input-container input,
.glass-field-container .field-input-container select,
.glass-field-container .field-input-container textarea,
.field-input-container.glass-small input,
.field-input-container.glass-small select,
.field-input-container.glass-small textarea {
  background: transparent !important;
  border: none !important;
  outline: none !important;
  width: 100% !important;
  color: var(--glass-text-primary) !important;
}

[data-theme="dark"] .glass-field-container .field-input-container,
[data-theme="dark"] .field-input-container.glass-small,
[data-theme="dark"] .professional-field-wrapper .field-input-container.glass-small {
  background: rgba(255, 255, 255, 0.1) !important;
  border-color: rgba(255, 255, 255, 0.15) !important;
}

[data-theme="dark"] .glass-field-container .field-input-container:hover,
[data-theme="dark"] .field-input-container.glass-small:hover,
[data-theme="dark"] .professional-field-wrapper .field-input-container.glass-small:hover {
  background: rgba(255, 255, 255, 0.15) !important;
  border-color: rgba(255, 255, 255, 0.2) !important;
}

[data-theme="dark"] .glass-field-container .field-input-container:focus-within,
[data-theme="dark"] .field-input-container.glass-small:focus-within,
[data-theme="dark"] .professional-field-wrapper .field-input-container.glass-small:focus-within {
  background: rgba(255, 255, 255, 0.2) !important;
  border-color: var(--glass-interactive) !important;
}

[data-theme="dark"] .glass-field-container .field-input-container input,
[data-theme="dark"] .glass-field-container .field-input-container select,
[data-theme="dark"] .glass-field-container .field-input-container textarea,
[data-theme="dark"] .field-input-container.glass-small input,
[data-theme="dark"] .field-input-container.glass-small select,
[data-theme="dark"] .field-input-container.glass-small textarea {
  color: var(--glass-text-primary-dark) !important;
}
